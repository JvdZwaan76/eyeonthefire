<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eye on the Fire - Premier Interactive Fire Map & Live Updates</title>
  <meta name="description" content="Eye on the Fire is your premier destination to monitor active wildfires near you with our interactive live map. Get real-time updates, safety tips, and community insights instantly.">
  <meta name="keywords" content="interactive fire map, live wildfire updates, fires near me, real-time fire monitoring, fire safety, Eye on the Fire">
  <meta name="author" content="Eye on the Fire Team">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://eyeonthefire.com/">
  <meta property="og:title" content="Eye on the Fire - Premier Interactive Fire Map">
  <meta property="og:description" content="Monitor active wildfires near you with Eye on the Fire’s interactive live map. Stay updated with real-time fire data and safety resources.">
  <meta property="og:url" content="https://eyeonthefire.com/">
  <meta property="og:image" content="/images/hero-bg.jpg">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="shortcut icon" href="/favicon/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="apple-touch-icon" href="/favicon/apple-touch-icon.png" sizes="180x180">
  <meta name="apple-mobile-web-app-title" content="eyeonthefire">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-T8RE6KDBEW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-T8RE6KDBEW');
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <link rel="stylesheet" href="/styles.css"> <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;700&family=Open+Sans:wght@300;400&display=swap" rel="stylesheet">
  <style>
    body { margin: 0; padding: 0; font-family: 'Open Sans', sans-serif; }
    .navbar {
      position: sticky; /* This might differ from the external CSS */
      top: 0;
      background: #b22222; /* Firebrick - different from external CSS */
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      z-index: 1000;
    }
    /* ... other inline styles from the file ... */
     .map-container { /* Note: This might conflict with .map-wrapper in external CSS */
        position: relative; width: 100%; max-width: 1200px; margin: 0 auto; padding-bottom: 56.25%; /* Aspect ratio */ height: 0; overflow: hidden; border: 2px solid #b22222; border-radius: 8px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    #fire-map { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }
    /* ... more inline styles ... */
    @media (max-width: 768px) { /* Inline media queries */
        .navbar { flex-direction: column; padding: 10px; }
        .nav-menu { display: none; flex-direction: column; width: 100%; text-align: center; }
        .nav-menu.active { display: flex; }
        .hamburger { display: flex; }
        /* ... other inline responsive styles ... */
    }
  </style>
</head>
<body>

  <nav class="navbar">
    <div class="navbar-header">
        <a href="#" class="logo">
            <img src="/images/fire-icon.png" alt="Eye on the Fire Logo"> <span class="logo-text">Eye on the Fire</span>
        </a>
        <button class="hamburger" id="hamburger-menu" aria-label="Toggle Menu">
            <span class="line"></span><span class="line"></span><span class="line"></span>
        </button>
    </div>
    <ul class="nav-menu" id="nav-menu">
        <li><a href="#map-section">Live Map</a></li>
        <li><a href="/recent-fires.html">Recent Fires</a></li> <li><a href="#about">Why Us</a></li>
        <li><a href="#prevention">Prevention</a></li>
        <li><a href="#community">Community</a></li>
    </ul>
    </nav>

  <header class="hero" id="home">
    <h1>Monitor Wildfires in Real-Time</h1>
    <p>Your premier destination for live interactive fire maps, updates, and safety information.</p>
    <a href="#map-section" class="cta-button">View Live Fire Map</a>
  </header>

  <section id="map-section" class="map-section">
       <div class="map-container">
           <div class="map-header">Interactive Wildfire Map</div>
           <div id="fire-map">
                 <div id="map-loading-message" style="position:absolute; top:50%; left:50%; transform: translate(-50%, -50%); font-size: 1.2em; color: #555; z-index: 1001;">Loading map data...</div>
                 <div id="map-error-message" style="position:absolute; top:50%; left:50%; transform: translate(-50%, -50%); font-size: 1.2em; color: red; display: none; text-align:center; background: rgba(255,255,255,0.8); padding: 15px; border-radius: 5px; z-index: 1001;"></div>
           </div>
      </div>
      <div id="geolocation-error" style="text-align: center; color: #b71c1c; margin-top: 10px; display: none;">Could not get your location. Showing default view.</div>
   </section>

  <section id="about" class="content-section">...</section>
  <section id="prevention" class="content-section">...</section>
  <section id="community" class="content-section">...</section>
  <footer>...</footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.fullscreen/2.0.0/Control.FullScreen.min.js" integrity="sha512-c6ydt5Rypa1ptlnH2U1u+JybARYppbD1qxgythCI4pJ9EOfNYEWlLBjxBX926O3tq5p4Aw5GTY68vT0FdKbG3w==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

  <script>
      // API Keys...
      const NASA_API_KEY = 'd152217c8391eb5b0fbd242290527ae8';
      const AIRNOW_API_KEY = '54044855-7B0C-4023-BEE4-8B3FCA172DED';
      const OPENCAGE_API_KEY = 'a40b9e954e50458bbc09ca24e70201a1';

      let map;
      let fireLayer = L.layerGroup();
      let airQualityLayer = L.layerGroup();
      let nifcLayer = L.layerGroup();
      let nwsLayer = L.layerGroup();
      let showFires = true;
      let showAirQuality = false;

      // Hamburger menu toggle
      document.getElementById('hamburger-menu').addEventListener('click', function() {
          document.getElementById('nav-menu').classList.toggle('active');
      });

      document.addEventListener('DOMContentLoaded', function() {
          map = L.map('fire-map').setView([34.0522, -118.2437], 8); // Default LA
          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
              attribution: '© OpenStreetMap contributors'
          }).addTo(map);

          if (navigator.geolocation) {
              navigator.geolocation.getCurrentPosition(position => {
                  const lat = position.coords.latitude;
                  const lon = position.coords.longitude;
                  map.setView([lat, lon], 10);
                  loadFireData(lat, lon);
              }, () => {
                  console.log('Geolocation failed. Using default.');
                  loadFireData(34.0522, -118.2437); // Load default LA data
              });
          } else {
              console.log('Geolocation not supported. Using default.');
              loadFireData(34.0522, -118.2437);
          }

          // Add event listeners for controls (assuming controls exist in HTML)
          document.getElementById('zip-form')?.addEventListener('submit', handleZipSearch);
          document.getElementById('zoom-ca')?.addEventListener('click', zoomToCA);
          document.getElementById('zoom-us')?.addEventListener('click', zoomToUS);
          document.getElementById('toggle-fires')?.addEventListener('click', toggleFires);
          document.getElementById('toggle-aqi')?.addEventListener('click', toggleAirQuality);
      });

      async function loadFireData(lat, lon) {
        // This version likely uses 'USA' area and split('\n') for FIRMS
        fireLayer.clearLayers();
        nifcLayer.clearLayers();
        try {
            // Simplified FIRMS call from user file - likely needs fixes
            const firmsUrl = `https://firms.modaps.eosdis.nasa.gov/api/area/csv/${NASA_API_KEY}/VIIRS_SNPP_NRT/USA/1`; // Likely needs bounding box
            const firmsResponse = await fetch(firmsUrl);
            if (!firmsResponse.ok) throw new Error(`FIRMS fetch failed: ${firmsResponse.status}`);
            const firmsData = await firmsResponse.text();
            const lines = firmsData.trim().split('\n'); // Likely needs /\r?\n/
            const headers = lines[0].split(',');
            const latIndex = headers.indexOf('latitude');
            const lonIndex = headers.indexOf('longitude');
            const acqDate = headers.indexOf('acq_date');
            const acqTime = headers.indexOf('acq_time');

            lines.slice(1).forEach(line => {
                const data = line.split(',');
                const lat = parseFloat(data[latIndex]);
                const lon = parseFloat(data[lonIndex]);
                if (!isNaN(lat) && !isNaN(lon)) {
                     L.marker([lat, lon], { icon: L.icon({ iconUrl: '/images/fire-icon.png', /* Absolute Path */ iconSize: [25, 25] }) })
                        .addTo(fireLayer)
                        .bindPopup(`FIRMS Hotspot<br>Detected: ${data[acqDate]} ${data[acqTime]}`);
                }
            });
        } catch (e) { console.error('FIRMS Error:', e); }

        try {
            // Simplified NIFC call from user file
            const nifcUrl = 'https://services3.arcgis.com/T4QMspbfLg3qTGWY/arcgis/rest/services/Current_WildlandFires/FeatureServer/0/query?where=1%3D1&outFields=IncidentName,Acres,PercentContained&returnGeometry=true&f=geojson';
            const nifcResponse = await fetch(nifcUrl);
            if (!nifcResponse.ok) throw new Error(`NIFC fetch failed: ${nifcResponse.status}`);
            const nifcData = await nifcResponse.json();
            L.geoJson(nifcData, {
                pointToLayer: function(feature, latlng) {
                     return L.marker(latlng, { icon: L.icon({ iconUrl: '/images/nifc-fire.png', /* Absolute Path */ iconSize: [30, 30] }) });
                },
                onEachFeature: function (feature, layer) {
                    if (feature.properties) {
                        layer.bindPopup(`<b>${feature.properties.IncidentName}</b><br>${feature.properties.Acres?.toLocaleString() || 'N/A'} Acres<br>${feature.properties.PercentContained ?? 'N/A'}% Contained`);
                    }
                }
            }).addTo(nifcLayer);
        } catch (e) { console.error('NIFC Error:', e); }

        // Simplified AirNow call from user file
        try {
            const airUrl = `https://www.airnowapi.org/aq/observation/latLong/current/?format=application/json&latitude=${lat}&longitude=${lon}&distance=25&API_KEY=${AIRNOW_API_KEY}`;
            const airResponse = await fetch(airUrl);
            if (!airResponse.ok) throw new Error(`AirNow fetch failed: ${airResponse.status}`);
            const airData = await airResponse.json();
            airData.forEach(report => {
                if(report.ParameterName === "PM2.5") {
                     L.circleMarker([report.Latitude, report.Longitude], { radius: 8, color: getAQIColor(report.AQI), fillOpacity: 0.7 })
                        .addTo(airQualityLayer)
                        .bindPopup(`${report.ReportingArea}: AQI ${report.AQI} (${report.Category.Name})`);
                }
            });
        } catch (e) { console.error('AirNow Error:', e); }

        if(showFires) fireLayer.addTo(map); // Add layers based on initial state
        if(showNIFC) nifcLayer.addTo(map);
        if(showAirQuality) airQualityLayer.addTo(map);
      }

      async function handleZipSearch(event) { /* ... logic from user file (may differ slightly) ... */ }
      function zoomToCA() { /* ... */ }
      function zoomToUS() { /* ... */ }
      function toggleFires() { /* ... likely toggles fireLayer ... */ }
      function toggleAirQuality() { /* ... likely toggles airQualityLayer ... */ }
      function getAQIColor(aqi) { /* ... */ }
      function displayMapError(message) { /* ... */ }

  </script>
</body>
</html>
