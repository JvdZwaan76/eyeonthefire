<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Real-time wildfire tracking and safety alerts for California. Professional-grade fire intelligence powered by NASA satellite data.">
    <title>Eye on the Fire | Real-Time Wildfire Tracking & Safety Platform</title>
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T8RE6KDBEW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-T8RE6KDBEW', {
        anonymize_ip: true,
        cookie_flags: 'SameSite=None;Secure'
      });
    </script>
    
    <!-- Preload critical resources -->
    <link rel="preload" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" as="style">
    <link rel="preload" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" as="script">
    
    <!-- Critical CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="assets/css/styles.css">
    
    <!-- Favicon and app icons -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon" href="apple-touch-icon.png">
    
    <!-- Open Graph meta tags -->
    <meta property="og:title" content="Eye on the Fire - Real-Time Wildfire Tracking">
    <meta property="og:description" content="Professional wildfire intelligence platform powered by NASA satellite data">
    <meta property="og:image" content="https://eyeonthefire.com/og-image.png">
    <meta property="og:url" content="https://eyeonthefire.com">
    
    <!-- Emergency service structured data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Eye on the Fire",
        "description": "Real-time wildfire tracking and safety alerts",
        "applicationCategory": "Emergency Services",
        "operatingSystem": "Web, iOS, Android",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        }
    }
    </script>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading-screen" class="loading-screen" aria-hidden="true">
        <div class="loading-content">
            <div class="fire-logo">üî•</div>
            <h2>Eye on the Fire</h2>
            <p>Loading real-time fire data...</p>
            <div class="loading-bar">
                <div class="loading-progress"></div>
            </div>
        </div>
    </div>

    <!-- Emergency Alert Banner -->
    <div id="emergency-alert" class="emergency-alert" role="alert" aria-live="assertive" style="display: none;">
        <div class="alert-content">
            <span class="alert-icon">‚ö†Ô∏è</span>
            <span class="alert-text"></span>
            <button class="alert-close" onclick="closeEmergencyAlert()" aria-label="Close alert">√ó</button>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="main-nav" role="navigation" aria-label="Main navigation">
        <div class="nav-brand">
            <span class="brand-icon">üî•</span>
            <span class="brand-text">Eye on the Fire</span>
        </div>
        
        <button class="nav-toggle" id="navToggle" aria-expanded="false" aria-controls="navMenu" aria-label="Toggle navigation menu">
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
            <span class="hamburger-line"></span>
        </button>
        
        <div class="nav-menu" id="navMenu" role="menu">
            <div class="nav-section">
                <h3 class="nav-section-title">Fire Intelligence</h3>
                <a href="index.html" class="nav-link active" role="menuitem">
                    <span class="nav-icon">üó∫Ô∏è</span>
                    <span>Live Map</span>
                </a>
                <a href="safety.html" class="nav-link" role="menuitem">
                    <span class="nav-icon">üõ°Ô∏è</span>
                    <span>Safety</span>
                </a>
                <a href="prevention.html" class="nav-link" role="menuitem">
                    <span class="nav-icon">üåø</span>
                    <span>Prevention</span>
                </a>
                <a href="alerts" class="nav-link" role="menuitem">
                    <span class="nav-icon">üö®</span>
                    <span>Alerts</span>
                </a>
            </div>
            
            <div class="nav-section">
                <h3 class="nav-section-title">Information</h3>
                <a href="about.html" class="nav-link" role="menuitem">
                    <span class="nav-icon">‚ÑπÔ∏è</span>
                    <span>About</span>
                </a>
                <a href="support" class="nav-link" role="menuitem">
                    <span class="nav-icon">üìû</span>
                    <span>Support</span>
                </a>
            </div>
            
            <div class="nav-section">
                <h3 class="nav-section-title">Account</h3>
                <a href="settings" class="nav-link" role="menuitem">
                    <span class="nav-icon">‚öôÔ∏è</span>
                    <span>Settings</span>
                </a>
            </div>
        </div>
    </nav>

    <!-- Map Container -->
    <main class="map-container" role="main">
        <div id="map" class="fire-map" aria-label="Interactive fire tracking map"></div>
        
        <!-- Map Controls Overlay -->
        <div class="map-controls" role="toolbar" aria-label="Map controls">
            <!-- Status Panel -->
            <div class="status-panel" role="complementary" aria-label="Fire status information">
                <div class="status-header">
                    <h2 class="status-title">Fire Status</h2>
                    <div class="live-indicator">
                        <span class="live-dot" aria-hidden="true"></span>
                        <span class="live-text">Live</span>
                    </div>
                </div>
                
                <div class="fire-summary">
                    <div class="fire-count">
                        <span class="count-number" id="fireCount">--</span>
                        <span class="count-label">Active Fires</span>
                    </div>
                    <div class="update-time">
                        <span id="lastUpdate">Loading...</span>
                    </div>
                </div>
            </div>

            <!-- Location Controls -->
            <div class="location-controls" role="group" aria-label="Location controls">
                <button class="control-button primary" id="findLocationBtn" onclick="findUserLocation()" aria-label="Find fires near my location">
                    <span class="button-icon">üìç</span>
                    <span class="button-text">Near Me</span>
                </button>
                
                <button class="control-button secondary" id="showAllBtn" onclick="showAllFires()" aria-label="Show all active fires">
                    <span class="button-icon">üî•</span>
                    <span class="button-text">All Fires</span>
                </button>
                
                <button class="control-button secondary" id="refreshBtn" onclick="refreshFireData()" aria-label="Refresh fire data">
                    <span class="button-icon">üîÑ</span>
                    <span class="button-text">Refresh</span>
                </button>
            </div>

            <!-- Map Layer Controls -->
            <div class="layer-controls" role="group" aria-label="Map layer controls">
                <h3 class="controls-title">Map Layers</h3>
                <div class="layer-toggles">
                    <label class="layer-toggle">
                        <input type="checkbox" id="satelliteHotspotsLayer" checked aria-describedby="satellite-help">
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">Satellite Hotspots</span>
                    </label>
                    
                    <label class="layer-toggle">
                        <input type="checkbox" id="weatherLayer" aria-describedby="weather-help">
                        <span class="toggle-slider"></span>
                        <span class="toggle-label">Weather Conditions</span>
                    </label>
                </div>
            </div>
        </div>

        <!-- Nearby Fires Panel (Hidden by default) -->
        <div class="nearby-panel" id="nearbyPanel" role="complementary" aria-label="Nearby fires information" style="display: none;">
            <div class="panel-header">
                <h3 class="panel-title">Fires Near You</h3>
                <button class="panel-close" onclick="closeNearbyPanel()" aria-label="Close nearby fires panel">√ó</button>
            </div>
            
            <div class="nearby-content">
                <div class="user-location">
                    <span class="location-icon">üìç</span>
                    <span class="location-text" id="userLocationText">Determining location...</span>
                </div>
                
                <div class="nearby-list" id="nearbyList" role="list">
                    <!-- Populated dynamically -->
                </div>
            </div>
        </div>
    </main>

    <!-- Fire Detail Modal -->
    <div class="fire-modal" id="fireModal" role="dialog" aria-modal="true" aria-labelledby="fireModalTitle" style="display: none;">
        <div class="modal-backdrop" onclick="closeFireModal()"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="fireModalTitle">Fire Details</h2>
                <button class="modal-close" onclick="closeFireModal()" aria-label="Close fire details">√ó</button>
            </div>
            
            <div class="modal-body" id="fireModalBody">
                <!-- Populated dynamically -->
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="site-footer" role="contentinfo">
        <div class="footer-content">
            <div class="footer-section">
                <p class="footer-text">Data provided by NASA FIRMS | Map powered by OpenStreetMap</p>
                <p class="footer-disclaimer">For emergency situations, always contact local authorities: 911</p>
            </div>
            
            <div class="footer-links">
                <a href="privacy" class="footer-link">Privacy</a>
                <a href="terms" class="footer-link">Terms</a>
                <a href="accessibility" class="footer-link">Accessibility</a>
            </div>
        </div>
    </footer>

    <!-- Help tooltips (screen reader friendly) -->
    <div id="satellite-help" class="sr-only">Shows real-time fire hotspots detected by NASA satellites</div>
    <div id="weather-help" class="sr-only">Displays weather conditions that affect fire behavior</div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="assets/js/app.js" defer></script>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
        
        // Track page view
        if (window.gtag) {
            gtag('event', 'page_view', {
                page_title: 'Live Fire Map',
                page_location: window.location.href
            });
        }
    </script>
</body>
</html>
