<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Eye on the Fire provides real-time fire detection maps using NASA FIRMS data to help you stay informed and safe.">
    <meta name="keywords" content="wildfire map, fire detection, NASA FIRMS, real-time fire tracking, fire safety">
    <meta name="author" content="Eye on the Fire">
    <meta name="robots" content="index, follow">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self' https://*.googleapis.com https://*.gstatic.com; script-src 'self' https://*.googleapis.com https://*.cloudflare.com https://unpkg.com https://www.googletagmanager.com https://code.jquery.com https://cdn.jsdelivr.net https://static.cloudflareinsights.com https://challenges.cloudflare.com 'sha256-mCfZrR9hBZAx19S6Y1T7bgXaiwMf8Uf1zof+Ak5or9c=' 'sha256-/7PhaH+ztlFW2+csTlHXjXSO3PowpcogAqSIj8ERDo4=' 'sha256-9VMs216ivDhbBD86w0PIIC+0ApOlBWhWv1h8idSAdyY=' 'sha256-uiFEbgd7Iq38yUvTVTr51p79HYjbvvBO8ysIsCKaT9g='; style-src 'self' https://*.googleapis.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net 'sha256-biLFinpqYMtWHmXfkA1BPeCY0/fNt46SAZ+BBk5YUog=' 'sha256-23acR0PJ3kXDLgv9CPYrFXr0yZxbKxqobtwFlafSfMk=' 'sha256-wQWxAQI8pn3DkJVaPcUeZKjSF+z72r9uFH5BRbS6ndk=' 'sha256-lLbK/9VSX8spw3W1ij9rR+3LwZU/SvMyeaBxc1aFgx8=' 'sha256-WysfLoUHtEbSa9EvId7Uj/jyvaLuBOIha+R1P+iImzk=' 'sha256-mmA4m52ZWPKWAzDvKQbF7Qhx9VHCZ2pcEdC0f9Xn/Po=' 'sha256-pzRbDTkOofZpG91nLe+vEuUeKxXX9yPEAiFygDXB4h4=' 'sha256-j69g0Z+HAbHBMIzQNFis9uADYR6LPo2LYlSo6DI4wy0=' 'sha256-g1+M02rsvlWQa9CjaRfEaZvT//NG7UhCKe8br+KXuF8=' 'sha256-IaM8xvcujDol1nAtq0BzSXIFdWOl+DiuhOV5dqL9STo=' 'sha256-PNsPul0zQFUiYu9XLVKzTdD5Cz5ghp1MT4H5/zAeI3Q=' 'sha256-/VVOq+Ws/EiUxf2CU6tsqsHdOWqBgHSgwBPqCTjYD3U=' 'sha256-zZp8BI/LRCsExnI71KZA79vRfTQ/33qQr5GcSWAOwto='; font-src 'self' https://fonts.gstatic.com; frame-src 'self' https://firms.modaps.eosdis.nasa.gov; connect-src 'self' https://eyeonthefire.com https://*.googleapis.com https://www.googletagmanager.com https://analytics.google.com https://www.google-analytics.com https://challenges.cloudflare.com; img-src 'self' https://*.gstatic.com https://eyeonthefire.com https://*.google.com https://*.googleapis.com data:;">
    <title>Eye on the Fire - Real-Time Fire Detection Map</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujTnHg4CGR2D7kSs0v4LLanw2qksYuRlEzO+tcaEPQogQ0KaoGN26/zrn20ImR1DfuLWnOo7a==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap">
    <link rel="stylesheet" href="/styles.css">
    <link rel="preload" href="/styles.css" as="style">
    <link rel="preload" href="/fireMap.js" as="script">
    <link rel="icon" type="image/png" href="https://eyeonthefire.com/favicon.ico">
</head>
<body>
    <div id="loading-overlay" class="loading-overlay">
        <div class="loader"></div>
        <p>Loading fire data...</p>
    </div>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="/">
                    <img src="https://eyeonthefire.com/logo.png" alt="Eye on the Fire Logo">
                </a>
            </div>
            <button class="hamburger" aria-expanded="false" aria-label="Toggle navigation">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <div class="nav-menu">
                <ul class="main-menu">
                    <li><a href="#home">Home</a></li>
                    <li><a href="#map-section">Map</a></li>
                    <li><a href="#about">About</a></li>
                    <li><a href="#resources">Resources</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </div>
        </nav>
    </header>
    <main>
        <section id="home" class="hero">
            <div class="hero-content">
                <h1>Eye on the Fire</h1>
                <p>Stay informed with real-time fire detection maps powered by NASA FIRMS data.</p>
                <a href="#map-section" class="cta-button">View Fire Map</a>
            </div>
        </section>
        <section id="map-section" class="map-section">
            <h2>Real-Time Fire Detection Map</h2>
            <p>Explore active fire detections across the globe using data from NASA FIRMS.</p>
            <div class="map-wrapper">
                <div id="map" class="map"></div>
                <div id="fallback-map" class="fallback-map">
                    <p class="fallback-note">Unable to load the map. View the NASA FIRMS map <a href="https://firms.modaps.eosdis.nasa.gov/map/#d:24hrs;@0,0,3z" target="_blank" rel="noopener noreferrer">here</a>.</p>
                </div>
                <div id="stats-panel" class="stats-panel">
                    <h3>Fire Statistics</h3>
                    <p id="fire-count">Loading fire data...</p>
                </div>
                <div id="turnstile-container" class="turnstile-container"></div>
                <div class="map-controls desktop-controls">
                    <button id="find-fires-near-me" title="Find Fires Near Me"><i class="fas fa-map-marker-alt"></i></button>
                    <button id="zoom-in" title="Zoom In"><i class="fas fa-plus"></i></button>
                    <button id="zoom-out" title="Zoom Out"><i class="fas fa-minus"></i></button>
                    <button id="fullscreen-toggle" title="Toggle Fullscreen"><i class="fas fa-expand"></i></button>
                    <button id="show-stats" title="Show Stats"><i class="fas fa-chart-bar"></i></button>
                </div>
                <div class="map-controls mobile-controls">
                    <button id="mobile-location" title="Find Fires Near Me"><i class="fas fa-map-marker-alt"></i></button>
                    <button id="mobile-zoom-in" title="Zoom In"><i class="fas fa-plus"></i></button>
                    <button id="mobile-zoom-out" title="Zoom Out"><i class="fas fa-minus"></i></button>
                </div>
            </div>
        </section>
        <section id="about" class="about">
            <h2>About Eye on the Fire</h2>
            <p>We provide real-time fire detection maps using data from NASA FIRMS to help communities stay informed and safe during wildfire events.</p>
        </section>
        <section id="resources" class="resources">
            <h2>Resources</h2>
            <ul>
                <li><a href="https://firms.modaps.eosdis.nasa.gov/" target="_blank" rel="noopener noreferrer">NASA FIRMS</a></li>
                <li><a href="https://www.ready.gov/wildfires" target="_blank" rel="noopener noreferrer">Wildfire Safety Tips</a></li>
                <li><a href="https://www.weather.gov/safety/wildfire" target="_blank" rel="noopener noreferrer">NOAA Wildfire Weather</a></li>
            </ul>
        </section>
        <section id="contact" class="contact">
            <h2>Contact Us</h2>
            <p>Email us at <a href="mailto:info@eyeonthefire.com">info@eyeonthefire.com</a> for inquiries or support.</p>
        </section>
    </main>
    <footer>
        <p>&copy; <span id="year"></span> Eye on the Fire. All rights reserved.</p>
    </footer>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD9MXRpmeXMKlezIOs3lPAjn0C5yLeTNUk&libraries=visualization,drawing,places&callback=initMap" defer></script>
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js" defer></script>
    <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
    <script src="/fireMap.js" defer></script>
    <script>
        function initMap() {
            console.log('Google Maps API initialized');
            if (window.fireMap && window.fireMap.onGoogleMapsLoaded) {
                window.fireMap.onGoogleMapsLoaded();
            }
        }
    </script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Check if FireMap is defined before initializing
            if (typeof FireMap !== 'undefined') {
                try {
                    window.fireMap = new FireMap();
                } catch (e) {
                    console.error('Failed to initialize FireMap:', e);
                    showFallbackMap();
                }
            } else {
                console.error('FireMap class is not defined. Showing fallback map.');
                showFallbackMap();
            }

            function showFallbackMap() {
                document.getElementById('map').style.display = 'none';
                document.getElementById('fallback-map').style.display = 'block';
                document.getElementById('loading-overlay').style.display = 'none';
            }

            // Navigation
            const hamburger = document.querySelector('.hamburger');
            const navMenu = document.querySelector('.nav-menu');
            const mainNavLinks = document.querySelectorAll('.main-menu a');
            if (hamburger && navMenu) {
                hamburger.addEventListener('click', () => {
                    const isActive = navMenu.classList.contains('active');
                    hamburger.classList.toggle('active');
                    navMenu.classList.toggle('active');
                    hamburger.setAttribute('aria-expanded', !isActive);
                });
            }
            if (navMenu) {
                mainNavLinks.forEach(link => {
                    link.addEventListener('click', () => {
                        if (hamburger && navMenu.classList.contains('active')) {
                            hamburger.classList.remove('active');
                            navMenu.classList.remove('active');
                            hamburger.setAttribute('aria-expanded', 'false');
                        }
                    });
                });
            }
            const yearSpan = document.getElementById('year');
            if (yearSpan) {
                yearSpan.textContent = new Date().getFullYear();
            }

            // Map controls with Turnstile
            if (window.fireMap) {
                document.getElementById('mobile-zoom-in').addEventListener('click', () => {
                    window.fireMap.zoomIn();
                });
                document.getElementById('mobile-zoom-out').addEventListener('click', () => {
                    window.fireMap.zoomOut();
                });
                document.getElementById('mobile-location').addEventListener('click', () => {
                    window.turnstile.render('#turnstile-container', {
                        sitekey: '0x4AAAAAABc1nqDeCwRviFAi',
                        callback: () => window.fireMap.getUserLocation()
                    });
                });
                document.getElementById('find-fires-near-me').addEventListener('click', () => {
                    window.turnstile.render('#turnstile-container', {
                        sitekey: '0x4AAAAAABc1nqDeCwRviFAi',
                        callback: () => window.fireMap.getUserLocation()
                    });
                });
                document.getElementById('fullscreen-toggle').addEventListener('click', () => {
                    document.querySelector('.map-wrapper').classList.toggle('fullscreen');
                    const isFullscreen = document.querySelector('.map-wrapper').classList.contains('fullscreen');
                    document.querySelector('#fullscreen-toggle i').classList.toggle('fa-expand', !isFullscreen);
                    document.querySelector('#fullscreen-toggle i').classList.toggle('fa-compress', isFullscreen);
                    window.fireMap.resize();
                });
                document.getElementById('recenter').addEventListener('click', () => {
                    window.turnstile.render('#turnstile-container', {
                        sitekey: '0x4AAAAAABc1nqDeCwRviFAi',
                        callback: () => window.fireMap.getUserLocation()
                    });
                });
                document.getElementById('zoom-in').addEventListener('click', () => {
                    window.fireMap.zoomIn();
                });
                document.getElementById('zoom-out').addEventListener('click', () => {
                    window.fireMap.zoomOut();
                });
                document.getElementById('show-stats').addEventListener('click', () => {
                    window.fireMap.toggleStatsPanel();
                });
            }
        });
    </script>
</body>
</html>
