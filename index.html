<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eye on the Fire - Interactive Live Wildfire Monitoring & Safety</title>
  <meta name="description" content="Monitor wildfires and air quality near you in real time with Eye on the Fire’s interactive map. Get live updates, prevention tips, and community resources to stay safe.">
  <meta name="keywords" content="interactive wildfire map, live fire updates, fires near me, real-time air quality, fire safety, wildfire monitoring, Eye on the Fire">
  <meta name="author" content="Eye on the Fire Team">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://eyeonthefire.com/">
  <meta property="og:title" content="Eye on the Fire - Interactive Live Wildfire Monitoring">
  <meta property="og:description" content="Track wildfires and air quality near you live with our interactive map. Stay informed with real-time updates and safety resources.">
  <meta property="og:url" content="https://eyeonthefire.com/">
  <meta property="og:image" content="/images/hero-bg.jpg">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Favicon Links -->
  <link rel="shortcut icon" href="/favicon/favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" href="/favicon/favicon-96x96.png" sizes="96x96">
  <link rel="apple-touch-icon" href="/favicon/apple-touch-icon.png" sizes="180x180">
  <meta name="apple-mobile-web-app-title" content="eyeonthefire">
  <link rel="manifest" href="/favicon/site.webmanifest">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-T8RE6KDBEW"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-T8RE6KDBEW');
  </script>
  <!-- Font Awesome for Social Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
  <link rel="stylesheet" href="styles.css">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;700&family=Open+Sans:wght@300;400&display=swap" rel="stylesheet">
  <style>
    .map-container {
      position: relative;
      width: 100%;
      max-width: 1000px;
      margin: 20px auto;
      padding-bottom: 56.25%;
      height: 0;
      overflow: hidden;
      border: 2px solid #b22222;
      border-radius: 8px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    #fire-map {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .map-header {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      background: rgba(178, 34, 34, 0.9);
      color: #fff;
      font-family: 'Montserrat', sans-serif;
      font-size: 20px;
      font-weight: 700;
      text-align: center;
      padding: 15px 0;
      z-index: 1000;
    }
    .map-controls {
      position: absolute;
      top: 60px;
      left: 10px;
      z-index: 1000;
      background: #fff;
      padding: 10px;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .map-controls button, .location-form button {
      display: inline-block;
      margin: 5px 0;
      padding: 8px 15px;
      background: #b22222;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-family: 'Montserrat', sans-serif;
      font-weight: 500;
    }
    .map-controls button:hover, .location-form button:hover {
      background: #8b0000;
    }
    .location-form {
      position: absolute;
      top: 60px;
      right: 10px;
      z-index: 1000;
      background: #fff;
      padding: 10px;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    .location-form input {
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 4px;
      font-family: 'Open Sans', sans-serif;
    }
    .location-form .disclosure {
      font-family: 'Open Sans', sans-serif;
      font-size: 12px;
      color: #666;
      text-align: center;
      margin-top: 5px;
    }
    .fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 9999;
      padding-bottom: 0;
      margin: 0;
    }
    .cta-banner {
      background: #b22222;
      color: #fff;
      padding: 15px;
      text-align: center;
      margin: 20px 0;
      border-radius: 8px;
      font-family: 'Montserrat', sans-serif;
      font-size: 18px;
      font-weight: 700;
    }
    .cta-banner a {
      color: #fff;
      text-decoration: underline;
    }
    @media (max-width: 600px) {
      .map-container {
        padding-bottom: 75%;
      }
      .map-controls, .location-form {
        top: 50px;
        left: 5px;
        right: auto;
      }
      .map-header {
        font-size: 16px;
        padding: 10px 0;
      }
      .cta-banner {
        font-size: 14px;
        padding: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Header with Parallax -->
  <header class="parallax" style="background-image: url('/images/hero-bg.jpg');">
    <nav class="navbar">
      <div class="hamburger">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
      <div class="logo">
        <img src="/images/logo.png" alt="Eye on the Fire Logo">
        <span class="logo-text">Eye on the Fire</span>
      </div>
      <ul class="nav-menu">
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">About Us</a></li>
        <li><a href="recent-fires.html">Recent Fires</a></li>
        <li><a href="#fires">Fires Near Me</a></li>
        <li><a href="#prevention">Prevention</a></li>
        <li><a href="#community">Community</a></li>
      </ul>
    </nav>
    <div class="hero">
      <h1>Stay Ahead of the Flames</h1>
      <p>Track wildfires live with our interactive map.</p>
      <a href="#map-section" class="cta-button">Explore the Map Now</a>
    </div>
  </header>

  <!-- Real-Time Fire Map Section -->
  <section class="map-section" id="map-section">
    <div class="content-wrapper">
      <div class="map-container" id="map-container">
        <div class="map-header">Real-Time Wildfire & Air Quality Map</div>
        <div class="map-controls">
          <button onclick="zoomToCA()" aria-label="Zoom to California">Zoom to CA</button>
          <button onclick="zoomToUS()" aria-label="View entire U.S.">View U.S.</button>
          <button onclick="toggleFires()" aria-label="Toggle active fire markers">Toggle Fires</button>
          <button onclick="toggleAirQuality()" aria-label="Toggle air quality markers">Toggle Air Quality</button>
          <button onclick="toggleFullscreen()" aria-label="Toggle fullscreen mode">Fullscreen</button>
        </div>
        <div class="location-form">
          <input type="text" id="zip-input" placeholder="Enter Zip Code" aria-label="Zip Code">
          <button onclick="checkFiresNow()" aria-label="Check fires near zip code">Check Fires Now</button>
          <p class="disclosure">USA & Canada only</p>
        </div>
        <div id="fire-map"></div>
      </div>
    </div>
  </section>

  <!-- Fires Near Me -->
  <section id="fires" class="content-section">
    <div class="content-wrapper">
      <h2>Fires Near Me</h2>
      <p>Use the map above or enter your zip code to track fires in your area.</p>
      <div class="cta-banner">Stay Informed! <a href="#map-section">Monitor Live Fires Near You</a></div>
    </div>
  </section>

  <!-- Prevention Resources -->
  <section id="prevention" class="parallax" style="background-image: url('/images/prevention-bg.jpg');">
    <div class="content-overlay">
      <h2>Fire Prevention Tips</h2>
      <div class="prevention-grid">
        <div class="prevention-item fade-in">
          <h3>Defensible Space</h3>
          <p>Clear vegetation within 30 feet of your home.</p>
        </div>
        <div class="prevention-item fade-in">
          <h3>Smoke Alarms</h3>
          <p>Test detectors monthly for early warnings.</p>
        </div>
        <div class="prevention-item fade-in">
          <h3>Evacuation Plan</h3>
          <p>Practice a family escape route twice a year.</p>
        </div>
      </div>
      <div class="cta-banner">See Fires in Real Time! <a href="#map-section">Check the Live Map</a></div>
    </div>
  </section>

  <!-- Community Section -->
  <section id="community" class="content-section">
    <div class="content-wrapper">
      <h2>Community Hub</h2>
      <p>Share your fire experiences with photos and videos.</p>
      <div class="upload-form">
        <input type="file" accept="image/*,video/*" id="upload-input">
        <button onclick="alert('Upload functionality coming soon!')">Submit</button>
      </div>
      <div class="gallery">
        <div class="gallery-item"><img src="/images/gallery-firefighter.jpg" alt="Firefighter battling blaze"></div>
        <div class="gallery-item"><img src="/images/gallery-aftermath.jpg" alt="Community wildfire recovery"></div>
      </div>
      <div class="cta-banner">Join Our Community! <a href="recent-fires.html">Track Recent Fires Live</a></div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <p>© 2025 Eye on the Fire | <a href="#privacy">Privacy</a> | <a href="#terms">Terms</a> | <a href="/status.html">Status</a></p>
    <div class="social-icons">
      <a href="https://twitter.com/eyeonthefire" target="_blank" rel="nofollow" aria-label="Follow us on Twitter">
        <i class="fab fa-twitter"></i>
      </a>
      <a href="https://facebook.com/eyeonthefire" target="_blank" rel="nofollow" aria-label="Follow us on Facebook">
        <i class="fab fa-facebook-f"></i>
      </a>
      <a href="https://instagram.com/eyeonthefire" target="_blank" rel="nofollow" aria-label="Follow us on Instagram">
        <i class="fab fa-instagram"></i>
      </a>
    </div>
    <div class="cta-banner">Stay Safe! <a href="#map-section">Use Our Live Fire Map</a></div>
  </footer>

  <!-- Structured Data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "Eye on the Fire",
    "url": "https://eyeonthefire.com/",
    "description": "Interactive live wildfire monitoring, air quality updates, prevention tips, and community resources.",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://eyeonthefire.com/#fires?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>

  <!-- Leaflet JS and Map Logic -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
  <script>
    let map, fireLayer, airQualityLayer;
    let showFires = true, showAirQuality = false;
    const FIRMS_API_KEY = 'd152217c8391eb5b0fbd242290527ae8';
    const AIRNOW_API_KEY = '54044855-7B0C-4023-BEE4-8B3FCA172DED';
    const OPENCAGE_API_KEY = 'YOUR_OPENCAGE_API_KEY'; // Replace with your OpenCage key

    const observer = new IntersectionObserver((entries) => {
      if (entries[0].isIntersecting && !map) {
        initMap();
        loadFireData();
        observer.unobserve(document.getElementById('map-container'));
        setInterval(loadFireData, 900000);
      }
    });
    observer.observe(document.getElementById('map-container'));

    function initMap() {
      map = L.map('fire-map').setView([34.0522, -118.2437], 10);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> | Data: FIRMS, NIFC, AirNow, NOAA'
      }).addTo(map);
      fireLayer = L.layerGroup().addTo(map);
      airQualityLayer = L.layerGroup();

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(pos => {
          map.setView([pos.coords.latitude, pos.coords.longitude], 10);
        }, () => console.log('Geolocation denied'));
      }
    }

    async function loadFireData(lat = 34.0522, lon = -118.2437) {
      fireLayer.clearLayers();
      airQualityLayer.clearLayers();

      try {
        const firmsUrl = `https://firms.modaps.eosdis.nasa.gov/api/area/csv/${FIRMS_API_KEY}/VIIRS_SNPP_NRT/-125,25,-65,50/1`;
        const firmsResponse = await fetch(firmsUrl);
        if (!firmsResponse.ok) throw new Error(`FIRMS API failed: ${firmsResponse.status}`);
        const firmsText = await firmsResponse.text();
        const firmsLines = firmsText.split('\n').slice(1);
        firmsLines.forEach(line => {
          const [lat, lon, , , acqDate, acqTime] = line.split(',');
          if (lat && lon) {
            L.marker([parseFloat(lat), parseFloat(lon)], { icon: L.icon({ iconUrl: '/images/fire-icon.png', iconSize: [25, 25] }) })
              .addTo(fireLayer)
              .bindPopup(`FIRMS Hotspot<br>Detected: ${acqDate} ${acqTime}`);
          }
        });
      } catch (e) { console.error('FIRMS Error:', e); }

      try {
        const nifcUrl = 'https://services3.arcgis.com/T4QMspbfLg3qTGWY/arcgis/rest/services/Current_WildlandFires/FeatureServer/0/query?where=1%3D1&outFields=IncidentName,Acres,PercentContained&returnGeometry=true&f=geojson';
        const nifcResponse = await fetch(nifcUrl);
        if (!nifcResponse.ok) throw new Error(`NIFC API failed: ${nifcResponse.status}`);
        const nifcData = await nifcResponse.json();
        nifcData.features.forEach(feature => {
          const { coordinates } = feature.geometry;
          const { IncidentName, Acres, PercentContained } = feature.properties;
          L.marker([coordinates[1], coordinates[0]], { icon: L.icon({ iconUrl: '/images/fire-icon.png', iconSize: [25, 25] }) })
            .addTo(fireLayer)
            .bindPopup(`<b>${IncidentName}</b><br>Acres: ${Acres}<br>Contained: ${PercentContained}%`);
        });
      } catch (e) { console.error('NIFC Error:', e); }

      try {
        const airNowUrl = `https://www.airnowapi.org/aq/observation/latLong/current/?format=application/json&latitude=${lat}&longitude=${lon}&distance=100&API_KEY=${AIRNOW_API_KEY}`;
        const airNowResponse = await fetch(airNowUrl);
        if (!airNowResponse.ok) throw new Error(`AirNow API failed: ${airNowResponse.status}`);
        const airNowData = await airNowResponse.json();
        airNowData.forEach(station => {
          const { Latitude, Longitude, AQI, ParameterName, Category } = station;
          if (ParameterName === 'PM2.5') {
            L.circleMarker([Latitude, Longitude], { radius: 10, color: aqiColor(AQI), fillOpacity: 0.5 })
              .addTo(airQualityLayer)
              .bindPopup(`PM2.5 AQI: ${AQI}<br>Category: ${Category.Name}`);
          }
        });
      } catch (e) { console.error('AirNow Error:', e); }

      try {
        const nwsUrl = 'https://api.weather.gov/alerts/active?event=Fire%20Weather%20Watch';
        const nwsResponse = await fetch(nwsUrl, { headers: { 'User-Agent': 'EyeOnTheFire (info@eyeonthefire.com)' } });
        if (!nwsResponse.ok) throw new Error(`NOAA API failed: ${nwsResponse.status}`);
        const nwsData = await nwsResponse.json();
        nwsData.features.forEach(alert => {
          const { coordinates } = alert.geometry;
          if (coordinates && coordinates[0]) {
            L.polygon(coordinates[0].map(coord => [coord[1], coord[0]]), { color: '#ff4500', fillOpacity: 0.3 })
              .addTo(fireLayer)
              .bindPopup(alert.properties.headline);
          }
        });
      } catch (e) { console.error('NOAA Error:', e); }
    }

    function aqiColor(aqi) {
      if (aqi <= 50) return '#00e400';
      if (aqi <= 100) return '#ffff00';
      if (aqi <= 150) return '#ff7e00';
      if (aqi <= 200) return '#ff0000';
      if (aqi <= 300) return '#8f3f97';
      return '#7e0023';
    }

    async function checkFiresNow() {
      const zip = document.getElementById('zip-input').value.trim();
      const usZipRegex = /^\d{5}$/;
      const caZipRegex = /^[A-Za-z]\d[A-Za-z][ -]?\d[A-Za-z]\d$/;

      if (!usZipRegex.test(zip) && !caZipRegex.test(zip)) {
        alert('Please enter a valid USA (e.g., 90210) or Canadian (e.g., V6B 2W9) zip code.');
        return;
      }

      try {
        const response = await fetch(`https://api.opencagedata.com/geocode/v1/json?q=${zip}&key=${OPENCAGE_API_KEY}&countrycode=us,ca&limit=1`);
        const data = await response.json();
        if (data.results.length > 0) {
          const { lat, lng } = data.results[0].geometry;
          map.setView([lat, lng], 10);
          loadFireData(lat, lng);
        } else {
          alert('Zip code not found in USA or Canada. Please try again.');
        }
      } catch (e) {
        console.error('Geocoding Error:', e);
        alert('Error finding location. Please try again.');
      }
    }

    function zoomToCA() { map.setView([36.7783, -119.4179], 6); }
    function zoomToUS() { map.setView([37.0902, -95.7129], 4); }
    function toggleFires() {
      showFires = !showFires;
      showFires ? fireLayer.addTo(map) : fireLayer.remove();
    }
    function toggleAirQuality() {
      showAirQuality = !showAirQuality;
      showAirQuality ? airQualityLayer.addTo(map) : airQualityLayer.remove();
    }
    function toggleFullscreen() {
      document.getElementById('map-container').classList.toggle('fullscreen');
      map.invalidateSize();
    }
  </script>

  <script src="scripts.js"></script>
</body>
</html>