<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com https://unpkg.com https://static.cloudflareinsights.com https://www.googletagmanager.com;
      style-src 'self' 'unsafe-inline' https://unpkg.com https://fonts.googleapis.com;
      connect-src 'self' https://eyeonthefire.com https://firms.modaps.eosdis.nasa.gov;
      img-src 'self' https://*.tile.openstreetmap.org data:;
      font-src https://fonts.gstatic.com;
      frame-src 'self' https://firms.modaps.eosdis.nasa.gov
    ">
    <title>Eye on the Fire - Live US Wildfire Map | Fires Near Me Tracker</title>
    <meta name="description" content="Track wildfires near you with Eye on the Fire's live US interactive map. Get real-time updates, safety guides, and emergency resources.">
    <meta name="keywords" content="wildfire map, fires near me, US wildfire tracker, real-time fire updates, wildfire safety">
    <meta property="og:title" content="Eye on the Fire - Live US Wildfire Map">
    <meta property="og:description" content="Track wildfires in real-time with our interactive US map. Stay informed and safe with updates and resources.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://eyeonthefire.com/">
    <meta property="og:image" content="https://eyeonthefire.com/images/hero-bg.jpg">
    <link rel="canonical" href="https://eyeonthefire.com/">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/MarkerCluster.Default.css" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
    <!-- Favicon Links -->
    <link rel="shortcut icon" href="/favicon/favicon.ico" type="image/x-icon">
    <link rel="icon" type="image/png" href="/favicon/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/favicon/favicon-16x16.png" sizes="16x16">
    <link rel="apple-touch-icon" href="/favicon/apple-touch-icon.png" sizes="180x180">
    <link rel="manifest" href="/favicon/site.webmanifest">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-T8RE6KDBEW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-T8RE6KDBEW');
    </script>
</head>
<body>
    <header class="navbar">
        <div class="navbar-container">
            <a href="index.html" class="logo-link">
                <div class="logo-container">
                    <img src="/images/eyeonthefire-logo.png" alt="Eye on the Fire Logo" id="navbar-logo">
                    <span>Eye on the Fire</span>
                </div>
            </a>
            <button class="hamburger" aria-label="Toggle navigation" aria-expanded="false">
                <span class="line line1"></span>
                <span class="line line2"></span>
                <span class="line line3"></span>
            </button>
            <nav class="nav-menu" id="main-nav">
                <ul class="main-menu">
                    <li><a href="about.html">About</a></li>
                    <li class="has-dropdown"> <a href="#">Prepare <i class="fas fa-caret-down"></i></a>
                        <ul class="dropdown">
                            <li><strong class="sub-header"><i class="fas fa-fire"></i> Get Ready</strong></li>
                            <li><a href="#prevention" class="sub-item">Home Hardening</a></li>
                            <li><a href="#prevention" class="sub-item">Defensible Space</a></li>
                            <li><a href="#prevention" class="sub-item">Fire-Smart Landscaping</a></li>
                            <li><strong class="sub-header"><i class="fas fa-fire"></i> Get Set</strong></li>
                            <li><a href="#">Wildfire Action Plan</a></li>
                            <li><a href="#">Family Preparedness</a></li>
                            <li><a href="#">Emergency Go Bag</a></li>
                            <li><a href="#">Insurance Check-up</a></li>
                            <li><strong class="sub-header"><i class="fas fa-fire"></i> Go!</strong></li>
                            <li><a href="#">Evacuation Guide</a></li>
                        </ul>
                    </li>
                    <li class="has-dropdown">
                        <a href="#prevention">Prevent <i class="fas fa-caret-down"></i></a>
                        <ul class="dropdown">
                            <li><strong class="sub-header"><i class="fas fa-shield-alt"></i> Prevention Topics</strong></li>
                            <li><a href="#" class="sub-item">Equipment & Vehicle Use</a></li>
                            <li><a href="#" class="sub-item">Campfire Safety</a></li>
                            <li><a href="#" class="sub-item">Fireworks Safety</a></li>
                            <li><a href="#" class="sub-item">Target Shooting Safety</a></li>
                            <li><a href="#" class="sub-item">Landowner Assistance</a></li>
                        </ul>
                    </li>
                    <li class="has-dropdown">
                        <a href="#">Safety Info <i class="fas fa-caret-down"></i></a>
                        <ul class="dropdown">
                            <li><strong class="sub-header"><i class="fas fa-info-circle"></i> Safety Topics</strong></li>
                            <li><a href="#" class="sub-item">Evacuation Planning</a></li>
                            <li><a href="#prevention" class="sub-item">Prevention Tips</a></li>
                            <li><a href="#" class="sub-item">Emergency Kits</a></li>
                        </ul>
                    </li>
                    <li><a href="#community">News & Resources</a></li>
                    <li class="has-dropdown">
                        <a href="#">Contact <i class="fas fa-caret-down"></i></a>
                        <ul class="dropdown">
                            <li><strong class="sub-header"><i class="fas fa-envelope"></i> Contact Options</strong></li>
                            <li><a href="#" class="sub-item">General Contact</a></li>
                            <li><a href="#" class="sub-item">Media Inquiries</a></li>
                            <li><a href="#" class="sub-item">Advertising Opportunities</a></li>
                        </ul>
                    </li>
                </ul>
            </nav>
        </div>
    </header>
    <section class="hero" id="home">
        <div class="hero-content">
            <h1>Monitor US Wildfires in Real-Time</h1>
            <p>Track active fires across the United States with our live interactive map. Get critical updates, safety alerts, and preparedness resources.</p>
            <a href="#map-section" class="cta-button">View Live US Fire Map</a>
        </div>
    </section>
    <section id="intro" class="content-section">
        <div class="container">
            <p class="section-intro">Welcome to Eye on the Fire, your central hub for tracking active <strong>wildfires near me</strong> across the United States. Our advanced <strong>interactive fire map</strong> provides <strong>real-time fire monitoring</strong>, helping you stay aware of developing situations and make informed decisions for your safety during the challenging <strong>US fire season</strong>. Explore the map below and utilize our resources for effective <strong>wildfire safety</strong> and <strong>emergency preparedness</strong>.</p>
        </div>
    </section>
    <hr class="section-divider">
    <section id="map-section" class="content-section">
        <div class="container">
            <h2 class="section-title">Interactive Live US Wildfire Tracker</h2>
            <p class="section-intro">Monitor the latest wildfire activity nationwide. Use the map controls to find <strong>fires near you</strong> anywhere in the US, zoom into specific regions, and explore data layers for a comprehensive view of <strong>current wildfires</strong> and activity.</p>
            <div class="map-usage-guide" role="region" aria-labelledby="map-guide-heading">
                <h4 id="map-guide-heading"><i class="fas fa-map-marked-alt" aria-hidden="true"></i> How to Use the Map:</h4>
                <ul>
                    <li><i class="fas fa-location-crosshairs" aria-hidden="true"></i><span>Click <strong>Locate Me</strong> to center the map on your current position and find potential <strong>wildfires near me</strong>.</span></li>
                    <li><i class="fas fa-search-plus" aria-hidden="true"></i><span>Use the <strong>+/- buttons</strong> or pinch/scroll to zoom in and out for regional detail.</span></li>
                    <li><i class="fas fa-undo" aria-hidden="true"></i><span>Click <strong>Reset View</strong> to return to the initial nationwide map extent.</span></li>
                    <li><i class="fas fa-fire" aria-hidden="true"></i><span>Fire icons indicate detected hotspots or reported incidents. Click icons for available details.</span></li>
                </ul>
            </div>
        </div>
        <main>
            <div id="root"></div>
        </main>
        <div class="container data-source-note">
            <small>Map data sourced from NASA FIRMS, NIFC, and other official US channels. Updates occur periodically. Always follow guidance from local emergency management officials.</small>
        </div>
    </section>
    <hr class="section-divider">
    <section id="about" class="content-section">
        <div class="container">
            <h2 class="section-title">Stay Informed, Stay Safe Nationwide</h2>
            <p class="section-intro">As wildfire risks impact communities across the <strong>United States</strong>, access to reliable, timely information is paramount. Eye on the Fire provides an essential service through our premier <strong>interactive fire map</strong>, consolidating data for clear, actionable insights nationwide. Our platform aids residents from coast to coast in assessing potential threats with <strong>real-time fire monitoring</strong>. Understanding current fire behavior is key to effective <strong>emergency preparedness</strong> and comprehensive <strong>fire safety</strong>. Trust Eye on the Fire for situational awareness.</p>
        </div>
    </section>
    <hr class="section-divider">
    <section id="prevention" class="content-section">
        <div class="container">
            <h2 class="section-title">Wildfire Prevention & Home Safety Guides</h2>
            <p class="section-intro">Protecting your property starts long before a wildfire approaches. Implementing <strong>fire prevention</strong> strategies like <strong>home hardening</strong> and creating <strong>defensible space</strong> are the most effective ways to increase your home's chance of survival, regardless of your location in the US. Explore these fundamental guides to build your <strong>wildfire action plan</strong>.</p>
            <div class="prevention-grid">
                <div class="prevention-item">
                    <i class="fas fa-home" aria-hidden="true"></i>
                    <h3>Defensible Space Zones</h3>
                    <p>Learn how to create and maintain recommended buffer zones around your home to reduce flammable vegetation and help stop fire spread. Essential nationwide guidance.</p>
                </div>
                <div class="prevention-item">
                    <i class="fas fa-tools" aria-hidden="true"></i>
                    <h3>Home Hardening Techniques</h3>
                    <p>Discover methods to make your home more resistant to embers and flames, focusing on roofs, vents, windows, siding, and decks applicable across the US.</p>
                </div>
                <div class="prevention-item">
                    <i class="fas fa-seedling" aria-hidden="true"></i>
                    <h3>Fire-Smart Landscaping</h3>
                    <p>Choose appropriate vegetation and spacing for plants near your home. Utilize fire-resistant native plants and maintain adequate irrigation for your climate zone.</p>
                </div>
            </div>
        </div>
    </section>
    <hr class="section-divider">
    <section id="community" class="content-section">
        <div class="container">
            <h2 class="section-title">National & Local Resources</h2>
            <p class="section-intro">Access official resources for emergency alerts, evacuation status, and support during wildfire events across the United States.</p>
            <div class="cta-banner">
                <p>Find National Interagency Fire Center (NIFC) Updates: <a href="https://www.nifc.gov/" target="_blank" rel="noopener noreferrer">Visit NIFC.gov</a></p>
            </div>
            <div class="gallery" role="list" aria-label="Community and wildfire images">
                <div class="gallery-item" role="listitem"><img src="/images/us-wildfire-community-response.jpg" alt="Diverse group of community members clearing brush together for wildfire prevention in a US neighborhood"></div>
                <div class="gallery-item" role="listitem"><img src="/images/us-firefighters-working.jpg" alt="US firefighters monitoring a controlled burn or wildfire line in a forested area"></div>
                <div class="gallery-item" role="listitem"><img src="/images/us-wildfire-landscape-recovery.jpg" alt="Wide landscape view showing ecological recovery with green shoots emerging after a US wildfire"></div>
            </div>
        </div>
    </section>
    <footer class="site-footer">
        <div class="footer-content">
            <div class="footer-section about">
                <h3 class="logo-text-footer">Eye on the Fire</h3>
                <p>Providing critical real-time wildfire monitoring and fire safety resources for the United States. Our interactive map helps communities stay informed and prepared.</p>
            </div>
            <div class="footer-section quick-links">
                <h3>Quick Links</h3>
                <ul>
                    <li><a href="#map-section">Live Map</a></li>
                    <li><a href="#prevention">Prevention</a></li>
                    <li><a href="#community">Resources</a></li>
                    <li><a href="#">Contact</a></li>
                </ul>
            </div>
            <div class="footer-section social-media">
                <h3>Follow Us</h3>
                <a href="https://x.com/eyeonthefire" class="fab fa-x"></a>
                <a href="https://facebook.com/eyeonthefire" class="fab fa-facebook"></a>
                <a href="https://instagram.com/eyeonthefire" class="fab fa-instagram"></a>
            </div>
        </div>
        <div class="footer-bottom">
            <p>© <span id="year"></span> Eye on the Fire. All rights reserved.</p>
            <p><a href="/terms">Terms of Use</a> | <a href="/privacy">Privacy Policy</a></p>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/react@18.2.0/dist/react.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/react-dom@18.2.0/dist/react-dom.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@babel/standalone@7.23.2/babel.min.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.markercluster/1.4.1/leaflet.markercluster.js"></script>
    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        function parseCSV(csvText) {
            console.log('Raw CSV data:', csvText.substring(0, 100));
            const rows = csvText.trim().split('\n').slice(1);
            console.log('Number of data rows:', rows.length);
            const fires = rows.map((row, index) => {
                const columns = row.split(',');
                console.log(`Row ${index + 1} columns:`, columns.length);
                if (columns.length < 7) {
                    console.warn(`Invalid row format at index ${index + 1}:`, row);
                    return null;
                }
                const lat = parseFloat(columns[0]);
                const lon = parseFloat(columns[1]);
                const acqDate = columns[5];
                const acqTime = columns[6];
                console.log(`Row ${index + 1} lat: ${lat}, lon: ${lon}`);
                if (!isNaN(lat) && !isNaN(lon)) {
                    return { lat, lon, title: `Fire on ${acqDate} at ${acqTime}` };
                }
                console.warn(`Invalid lat/lon at row ${index + 1}`);
                return null;
            }).filter(fire => fire !== null);
            console.log('Parsed fires:', fires);
            return fires;
        }

        async function loadFireData() {
            try {
                const apiUrl = '/api/nasa/';
                console.log('Fetching from:', apiUrl);
                const response = await fetch(apiUrl);
                if (!response.ok) {
                    const errorText = await response.text();
                    console.error('API error response:', errorText);
                    throw new Error(`HTTP error! status: ${response.status}, body: ${errorText}`);
                }
                const data = await response.json();
                const fires = (data.events || []).map(event => ({
                    lat: event.geometry[0].coordinates[1],
                    lon: event.geometry[0].coordinates[0],
                    title: event.title || 'Active Fire'
                }));
                console.log('Fetched fires:', fires.length);
                return fires;
            } catch (error) {
                console.error('Error fetching server data:', error);
                try {
                    const apiKey = 'YOUR_ACTUAL_NASA_FIRMS_API_KEY'; // Replace with your valid NASA FIRMS API key
                    const firmsUrl = `https://firms.modaps.eosdis.nasa.gov/api/area/csv/${apiKey}/VIIRS_SNPP_NRT/world/1`;
                    console.log('Falling back to NASA FIRMS:', firmsUrl);
                    const response = await fetch(firmsUrl);
                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error('FIRMS API error response:', errorText);
                        throw new Error(`FIRMS HTTP error! status: ${response.status}, body: ${errorText}`);
                    }
                    const csvText = await response.text();
                    const fires = parseCSV(csvText);
                    console.log('Fetched FIRMS fires:', fires.length);
                    return fires;
                } catch (firmsError) {
                    console.error('Error fetching FIRMS data:', firmsError);
                    const fallback = [
                        { lat: 37.7749, lon: -122.4194, title: 'San Francisco Fire' },
                        { lat: 34.0522, lon: -118.2437, title: 'Los Angeles Fire' }
                    ];
                    console.log('Using fallback data:', fallback);
                    return fallback;
                }
            }
        }

        const MapComponent = () => {
            const [fires, setFires] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const mapContainerRef = useRef(null);
            const mapRef = useRef(null);
            const initialized = useRef(false);

            useEffect(() => {
                if (!initialized.current) {
                    initialized.current = true;
                    loadFireData().then(data => {
                        setFires(data);
                        setLoading(false);
                    }).catch(err => {
                        setError('Failed to load fire data.');
                        setLoading(false);
                    });
                }
            }, []);

            useEffect(() => {
                if (mapContainerRef.current && !mapRef.current) {
                    mapRef.current = L.map(mapContainerRef.current).setView([36.0, -120.0], 6);
                    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                        attribution: '© OpenStreetMap contributors'
                    }).addTo(mapRef.current);
                    console.log('Map initialized');
                }
            }, []);

            useEffect(() => {
                if (mapRef.current && fires.length > 0) {
                    const markers = fires.map(fire => {
                        console.log(`Adding marker at: ${fire.lat}, ${fire.lon}`);
                        return L.marker([fire.lat, fire.lon]).bindPopup(fire.title);
                    });
                    L.layerGroup(markers).addTo(mapRef.current);
                    console.log('Added markers:', fires.length);
                }
            }, [fires]);

            return (
                <div className="map-container">
                    {loading && <div className="loading">Loading map...</div>}
                    {error && <div className="error">{error}</div>}
                    <div ref={mapContainerRef} id="map"></div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<MapComponent />);
    </script>
    <script>
        document.getElementById('year').textContent = new Date().getFullYear();
        const hamburger = document.querySelector('.hamburger');
        const navMenu = document.querySelector('.nav-menu');
        hamburger.addEventListener('click', () => {
            hamburger.classList.toggle('active');
            navMenu.classList.toggle('active');
        });
        document.querySelectorAll('.has-dropdown > a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const dropdown = link.nextElementSibling;
                dropdown.classList.toggle('active');
                link.querySelector('.fa-caret-down').classList.toggle('rotate');
            });
        });
    </script>
    <script>var _0x3f3b=["https://eyeonthefire.com/cdn-cgi/rum?","POST","open","send"];var xhr=new XMLHttpRequest();xhr[_0x3f3b[2]](_0x3f3b[1],_0x3f3b[0]);xhr[_0x3f3b[3]]()</script>
    <script>var _0x4e4b=["https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015","createElement","script","src","async","appendChild"];var script=document[_0x4e4b[1]](_0x4e4b[2]);script[_0x4e4b[3]]=_0x4e4b[0];script[_0x4e4b[4]]=true;document.body[_0x4e4b[5]](script)</script>
</body>
</html>
